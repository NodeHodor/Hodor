{"type":"Program","start":0,"end":1230,"loc":{"start":{"line":1,"column":0},"end":{"line":52,"column":0}},"body":[{"type":"VariableDeclaration","start":33,"end":64,"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":31}},"declarations":[{"type":"VariableDeclarator","start":37,"end":63,"loc":{"start":{"line":5,"column":4},"end":{"line":5,"column":30}},"id":{"type":"Identifier","start":37,"end":43,"loc":{"start":{"line":5,"column":4},"end":{"line":5,"column":10}},"name":"crypto"},"init":{"type":"CallExpression","start":46,"end":63,"loc":{"start":{"line":5,"column":13},"end":{"line":5,"column":30}},"callee":{"type":"Identifier","start":46,"end":53,"loc":{"start":{"line":5,"column":13},"end":{"line":5,"column":20}},"name":"require"},"arguments":[{"type":"Literal","start":54,"end":62,"loc":{"start":{"line":5,"column":21},"end":{"line":5,"column":29}},"value":"crypto","raw":"'crypto'"}],"optional":false}}],"kind":"var"},{"type":"ExpressionStatement","start":202,"end":555,"loc":{"start":{"line":16,"column":0},"end":{"line":24,"column":2}},"expression":{"type":"AssignmentExpression","start":202,"end":554,"loc":{"start":{"line":16,"column":0},"end":{"line":24,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":202,"end":214,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":12}},"object":{"type":"Identifier","start":202,"end":209,"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":7}},"name":"exports"},"property":{"type":"Identifier","start":210,"end":214,"loc":{"start":{"line":16,"column":8},"end":{"line":16,"column":12}},"name":"sign"},"computed":false,"optional":false},"right":{"type":"FunctionExpression","start":217,"end":554,"loc":{"start":{"line":16,"column":15},"end":{"line":24,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":226,"end":229,"loc":{"start":{"line":16,"column":24},"end":{"line":16,"column":27}},"name":"val"},{"type":"Identifier","start":231,"end":237,"loc":{"start":{"line":16,"column":29},"end":{"line":16,"column":35}},"name":"secret"}],"body":{"type":"BlockStatement","start":238,"end":554,"loc":{"start":{"line":16,"column":36},"end":{"line":24,"column":1}},"body":[{"type":"IfStatement","start":242,"end":336,"loc":{"start":{"line":17,"column":2},"end":{"line":17,"column":96}},"test":{"type":"BinaryExpression","start":246,"end":268,"loc":{"start":{"line":17,"column":6},"end":{"line":17,"column":28}},"left":{"type":"Literal","start":246,"end":254,"loc":{"start":{"line":17,"column":6},"end":{"line":17,"column":14}},"value":"string","raw":"'string'"},"operator":"!=","right":{"type":"UnaryExpression","start":258,"end":268,"loc":{"start":{"line":17,"column":18},"end":{"line":17,"column":28}},"operator":"typeof","prefix":true,"argument":{"type":"Identifier","start":265,"end":268,"loc":{"start":{"line":17,"column":25},"end":{"line":17,"column":28}},"name":"val"}}},"consequent":{"type":"ThrowStatement","start":270,"end":336,"loc":{"start":{"line":17,"column":30},"end":{"line":17,"column":96}},"argument":{"type":"NewExpression","start":276,"end":335,"loc":{"start":{"line":17,"column":36},"end":{"line":17,"column":95}},"callee":{"type":"Identifier","start":280,"end":289,"loc":{"start":{"line":17,"column":40},"end":{"line":17,"column":49}},"name":"TypeError"},"arguments":[{"type":"Literal","start":290,"end":334,"loc":{"start":{"line":17,"column":50},"end":{"line":17,"column":94}},"value":"Cookie value must be provided as a string.","raw":"\"Cookie value must be provided as a string.\""}]}},"alternate":null},{"type":"IfStatement","start":339,"end":425,"loc":{"start":{"line":18,"column":2},"end":{"line":18,"column":88}},"test":{"type":"BinaryExpression","start":343,"end":368,"loc":{"start":{"line":18,"column":6},"end":{"line":18,"column":31}},"left":{"type":"Literal","start":343,"end":351,"loc":{"start":{"line":18,"column":6},"end":{"line":18,"column":14}},"value":"string","raw":"'string'"},"operator":"!=","right":{"type":"UnaryExpression","start":355,"end":368,"loc":{"start":{"line":18,"column":18},"end":{"line":18,"column":31}},"operator":"typeof","prefix":true,"argument":{"type":"Identifier","start":362,"end":368,"loc":{"start":{"line":18,"column":25},"end":{"line":18,"column":31}},"name":"secret"}}},"consequent":{"type":"ThrowStatement","start":370,"end":425,"loc":{"start":{"line":18,"column":33},"end":{"line":18,"column":88}},"argument":{"type":"NewExpression","start":376,"end":424,"loc":{"start":{"line":18,"column":39},"end":{"line":18,"column":87}},"callee":{"type":"Identifier","start":380,"end":389,"loc":{"start":{"line":18,"column":43},"end":{"line":18,"column":52}},"name":"TypeError"},"arguments":[{"type":"Literal","start":390,"end":423,"loc":{"start":{"line":18,"column":53},"end":{"line":18,"column":86}},"value":"Secret string must be provided.","raw":"\"Secret string must be provided.\""}]}},"alternate":null},{"type":"ReturnStatement","start":428,"end":552,"loc":{"start":{"line":19,"column":2},"end":{"line":23,"column":25}},"argument":{"type":"BinaryExpression","start":435,"end":551,"loc":{"start":{"line":19,"column":9},"end":{"line":23,"column":24}},"left":{"type":"BinaryExpression","start":435,"end":444,"loc":{"start":{"line":19,"column":9},"end":{"line":19,"column":18}},"left":{"type":"Identifier","start":435,"end":438,"loc":{"start":{"line":19,"column":9},"end":{"line":19,"column":12}},"name":"val"},"operator":"+","right":{"type":"Literal","start":441,"end":444,"loc":{"start":{"line":19,"column":15},"end":{"line":19,"column":18}},"value":".","raw":"'.'"}},"operator":"+","right":{"type":"CallExpression","start":447,"end":551,"loc":{"start":{"line":19,"column":21},"end":{"line":23,"column":24}},"callee":{"type":"MemberExpression","start":447,"end":539,"loc":{"start":{"line":19,"column":21},"end":{"line":23,"column":12}},"object":{"type":"CallExpression","start":447,"end":526,"loc":{"start":{"line":19,"column":21},"end":{"line":22,"column":21}},"callee":{"type":"MemberExpression","start":447,"end":516,"loc":{"start":{"line":19,"column":21},"end":{"line":22,"column":11}},"object":{"type":"CallExpression","start":447,"end":504,"loc":{"start":{"line":19,"column":21},"end":{"line":21,"column":16}},"callee":{"type":"MemberExpression","start":447,"end":499,"loc":{"start":{"line":19,"column":21},"end":{"line":21,"column":11}},"object":{"type":"CallExpression","start":447,"end":487,"loc":{"start":{"line":19,"column":21},"end":{"line":20,"column":33}},"callee":{"type":"MemberExpression","start":447,"end":469,"loc":{"start":{"line":19,"column":21},"end":{"line":20,"column":15}},"object":{"type":"Identifier","start":447,"end":453,"loc":{"start":{"line":19,"column":21},"end":{"line":19,"column":27}},"name":"crypto"},"property":{"type":"Identifier","start":459,"end":469,"loc":{"start":{"line":20,"column":5},"end":{"line":20,"column":15}},"name":"createHmac"},"computed":false,"optional":false},"arguments":[{"type":"Literal","start":470,"end":478,"loc":{"start":{"line":20,"column":16},"end":{"line":20,"column":24}},"value":"sha256","raw":"'sha256'"},{"type":"Identifier","start":480,"end":486,"loc":{"start":{"line":20,"column":26},"end":{"line":20,"column":32}},"name":"secret"}],"optional":false},"property":{"type":"Identifier","start":493,"end":499,"loc":{"start":{"line":21,"column":5},"end":{"line":21,"column":11}},"name":"update"},"computed":false,"optional":false},"arguments":[{"type":"Identifier","start":500,"end":503,"loc":{"start":{"line":21,"column":12},"end":{"line":21,"column":15}},"name":"val"}],"optional":false},"property":{"type":"Identifier","start":510,"end":516,"loc":{"start":{"line":22,"column":5},"end":{"line":22,"column":11}},"name":"digest"},"computed":false,"optional":false},"arguments":[{"type":"Literal","start":517,"end":525,"loc":{"start":{"line":22,"column":12},"end":{"line":22,"column":20}},"value":"base64","raw":"'base64'"}],"optional":false},"property":{"type":"Identifier","start":532,"end":539,"loc":{"start":{"line":23,"column":5},"end":{"line":23,"column":12}},"name":"replace"},"computed":false,"optional":false},"arguments":[{"type":"Literal","start":540,"end":546,"loc":{"start":{"line":23,"column":13},"end":{"line":23,"column":19}},"value":{},"raw":"/\\=+$/","regex":{"pattern":"\\=+$","flags":""}},{"type":"Literal","start":548,"end":550,"loc":{"start":{"line":23,"column":21},"end":{"line":23,"column":23}},"value":"","raw":"''"}],"optional":false}}}]}}}},{"type":"ExpressionStatement","start":764,"end":1124,"loc":{"start":{"line":36,"column":0},"end":{"line":43,"column":2}},"expression":{"type":"AssignmentExpression","start":764,"end":1123,"loc":{"start":{"line":36,"column":0},"end":{"line":43,"column":1}},"operator":"=","left":{"type":"MemberExpression","start":764,"end":778,"loc":{"start":{"line":36,"column":0},"end":{"line":36,"column":14}},"object":{"type":"Identifier","start":764,"end":771,"loc":{"start":{"line":36,"column":0},"end":{"line":36,"column":7}},"name":"exports"},"property":{"type":"Identifier","start":772,"end":778,"loc":{"start":{"line":36,"column":8},"end":{"line":36,"column":14}},"name":"unsign"},"computed":false,"optional":false},"right":{"type":"FunctionExpression","start":781,"end":1123,"loc":{"start":{"line":36,"column":17},"end":{"line":43,"column":1}},"id":null,"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":790,"end":793,"loc":{"start":{"line":36,"column":26},"end":{"line":36,"column":29}},"name":"val"},{"type":"Identifier","start":795,"end":801,"loc":{"start":{"line":36,"column":31},"end":{"line":36,"column":37}},"name":"secret"}],"body":{"type":"BlockStatement","start":802,"end":1123,"loc":{"start":{"line":36,"column":38},"end":{"line":43,"column":1}},"body":[{"type":"IfStatement","start":806,"end":896,"loc":{"start":{"line":37,"column":2},"end":{"line":37,"column":92}},"test":{"type":"BinaryExpression","start":810,"end":832,"loc":{"start":{"line":37,"column":6},"end":{"line":37,"column":28}},"left":{"type":"Literal","start":810,"end":818,"loc":{"start":{"line":37,"column":6},"end":{"line":37,"column":14}},"value":"string","raw":"'string'"},"operator":"!=","right":{"type":"UnaryExpression","start":822,"end":832,"loc":{"start":{"line":37,"column":18},"end":{"line":37,"column":28}},"operator":"typeof","prefix":true,"argument":{"type":"Identifier","start":829,"end":832,"loc":{"start":{"line":37,"column":25},"end":{"line":37,"column":28}},"name":"val"}}},"consequent":{"type":"ThrowStatement","start":834,"end":896,"loc":{"start":{"line":37,"column":30},"end":{"line":37,"column":92}},"argument":{"type":"NewExpression","start":840,"end":895,"loc":{"start":{"line":37,"column":36},"end":{"line":37,"column":91}},"callee":{"type":"Identifier","start":844,"end":853,"loc":{"start":{"line":37,"column":40},"end":{"line":37,"column":49}},"name":"TypeError"},"arguments":[{"type":"Literal","start":854,"end":894,"loc":{"start":{"line":37,"column":50},"end":{"line":37,"column":90}},"value":"Signed cookie string must be provided.","raw":"\"Signed cookie string must be provided.\""}]}},"alternate":null},{"type":"IfStatement","start":899,"end":985,"loc":{"start":{"line":38,"column":2},"end":{"line":38,"column":88}},"test":{"type":"BinaryExpression","start":903,"end":928,"loc":{"start":{"line":38,"column":6},"end":{"line":38,"column":31}},"left":{"type":"Literal","start":903,"end":911,"loc":{"start":{"line":38,"column":6},"end":{"line":38,"column":14}},"value":"string","raw":"'string'"},"operator":"!=","right":{"type":"UnaryExpression","start":915,"end":928,"loc":{"start":{"line":38,"column":18},"end":{"line":38,"column":31}},"operator":"typeof","prefix":true,"argument":{"type":"Identifier","start":922,"end":928,"loc":{"start":{"line":38,"column":25},"end":{"line":38,"column":31}},"name":"secret"}}},"consequent":{"type":"ThrowStatement","start":930,"end":985,"loc":{"start":{"line":38,"column":33},"end":{"line":38,"column":88}},"argument":{"type":"NewExpression","start":936,"end":984,"loc":{"start":{"line":38,"column":39},"end":{"line":38,"column":87}},"callee":{"type":"Identifier","start":940,"end":949,"loc":{"start":{"line":38,"column":43},"end":{"line":38,"column":52}},"name":"TypeError"},"arguments":[{"type":"Literal","start":950,"end":983,"loc":{"start":{"line":38,"column":53},"end":{"line":38,"column":86}},"value":"Secret string must be provided.","raw":"\"Secret string must be provided.\""}]}},"alternate":null},{"type":"VariableDeclaration","start":988,"end":1071,"loc":{"start":{"line":39,"column":2},"end":{"line":40,"column":38}},"declarations":[{"type":"VariableDeclarator","start":992,"end":1032,"loc":{"start":{"line":39,"column":6},"end":{"line":39,"column":46}},"id":{"type":"Identifier","start":992,"end":995,"loc":{"start":{"line":39,"column":6},"end":{"line":39,"column":9}},"name":"str"},"init":{"type":"CallExpression","start":998,"end":1032,"loc":{"start":{"line":39,"column":12},"end":{"line":39,"column":46}},"callee":{"type":"MemberExpression","start":998,"end":1007,"loc":{"start":{"line":39,"column":12},"end":{"line":39,"column":21}},"object":{"type":"Identifier","start":998,"end":1001,"loc":{"start":{"line":39,"column":12},"end":{"line":39,"column":15}},"name":"val"},"property":{"type":"Identifier","start":1002,"end":1007,"loc":{"start":{"line":39,"column":16},"end":{"line":39,"column":21}},"name":"slice"},"computed":false,"optional":false},"arguments":[{"type":"Literal","start":1008,"end":1009,"loc":{"start":{"line":39,"column":22},"end":{"line":39,"column":23}},"value":0,"raw":"0"},{"type":"CallExpression","start":1011,"end":1031,"loc":{"start":{"line":39,"column":25},"end":{"line":39,"column":45}},"callee":{"type":"MemberExpression","start":1011,"end":1026,"loc":{"start":{"line":39,"column":25},"end":{"line":39,"column":40}},"object":{"type":"Identifier","start":1011,"end":1014,"loc":{"start":{"line":39,"column":25},"end":{"line":39,"column":28}},"name":"val"},"property":{"type":"Identifier","start":1015,"end":1026,"loc":{"start":{"line":39,"column":29},"end":{"line":39,"column":40}},"name":"lastIndexOf"},"computed":false,"optional":false},"arguments":[{"type":"Literal","start":1027,"end":1030,"loc":{"start":{"line":39,"column":41},"end":{"line":39,"column":44}},"value":".","raw":"'.'"}],"optional":false}],"optional":false}},{"type":"VariableDeclarator","start":1039,"end":1070,"loc":{"start":{"line":40,"column":6},"end":{"line":40,"column":37}},"id":{"type":"Identifier","start":1039,"end":1042,"loc":{"start":{"line":40,"column":6},"end":{"line":40,"column":9}},"name":"mac"},"init":{"type":"CallExpression","start":1045,"end":1070,"loc":{"start":{"line":40,"column":12},"end":{"line":40,"column":37}},"callee":{"type":"MemberExpression","start":1045,"end":1057,"loc":{"start":{"line":40,"column":12},"end":{"line":40,"column":24}},"object":{"type":"Identifier","start":1045,"end":1052,"loc":{"start":{"line":40,"column":12},"end":{"line":40,"column":19}},"name":"exports"},"property":{"type":"Identifier","start":1053,"end":1057,"loc":{"start":{"line":40,"column":20},"end":{"line":40,"column":24}},"name":"sign"},"computed":false,"optional":false},"arguments":[{"type":"Identifier","start":1058,"end":1061,"loc":{"start":{"line":40,"column":25},"end":{"line":40,"column":28}},"name":"str"},{"type":"Identifier","start":1063,"end":1069,"loc":{"start":{"line":40,"column":30},"end":{"line":40,"column":36}},"name":"secret"}],"optional":false}}],"kind":"var"},{"type":"ReturnStatement","start":1077,"end":1121,"loc":{"start":{"line":42,"column":2},"end":{"line":42,"column":46}},"argument":{"type":"ConditionalExpression","start":1084,"end":1120,"loc":{"start":{"line":42,"column":9},"end":{"line":42,"column":45}},"test":{"type":"BinaryExpression","start":1084,"end":1106,"loc":{"start":{"line":42,"column":9},"end":{"line":42,"column":31}},"left":{"type":"CallExpression","start":1084,"end":1093,"loc":{"start":{"line":42,"column":9},"end":{"line":42,"column":18}},"callee":{"type":"Identifier","start":1084,"end":1088,"loc":{"start":{"line":42,"column":9},"end":{"line":42,"column":13}},"name":"sha1"},"arguments":[{"type":"Identifier","start":1089,"end":1092,"loc":{"start":{"line":42,"column":14},"end":{"line":42,"column":17}},"name":"mac"}],"optional":false},"operator":"==","right":{"type":"CallExpression","start":1097,"end":1106,"loc":{"start":{"line":42,"column":22},"end":{"line":42,"column":31}},"callee":{"type":"Identifier","start":1097,"end":1101,"loc":{"start":{"line":42,"column":22},"end":{"line":42,"column":26}},"name":"sha1"},"arguments":[{"type":"Identifier","start":1102,"end":1105,"loc":{"start":{"line":42,"column":27},"end":{"line":42,"column":30}},"name":"val"}],"optional":false}},"consequent":{"type":"Identifier","start":1109,"end":1112,"loc":{"start":{"line":42,"column":34},"end":{"line":42,"column":37}},"name":"str"},"alternate":{"type":"Literal","start":1115,"end":1120,"loc":{"start":{"line":42,"column":40},"end":{"line":42,"column":45}},"value":false,"raw":"false"}}}]}}}},{"type":"FunctionDeclaration","start":1146,"end":1229,"loc":{"start":{"line":49,"column":0},"end":{"line":51,"column":1}},"id":{"type":"Identifier","start":1155,"end":1159,"loc":{"start":{"line":49,"column":9},"end":{"line":49,"column":13}},"name":"sha1"},"expression":false,"generator":false,"async":false,"params":[{"type":"Identifier","start":1160,"end":1163,"loc":{"start":{"line":49,"column":14},"end":{"line":49,"column":17}},"name":"str"}],"body":{"type":"BlockStatement","start":1164,"end":1229,"loc":{"start":{"line":49,"column":18},"end":{"line":51,"column":1}},"body":[{"type":"ReturnStatement","start":1168,"end":1227,"loc":{"start":{"line":50,"column":2},"end":{"line":50,"column":61}},"argument":{"type":"CallExpression","start":1175,"end":1226,"loc":{"start":{"line":50,"column":9},"end":{"line":50,"column":60}},"callee":{"type":"MemberExpression","start":1175,"end":1219,"loc":{"start":{"line":50,"column":9},"end":{"line":50,"column":53}},"object":{"type":"CallExpression","start":1175,"end":1212,"loc":{"start":{"line":50,"column":9},"end":{"line":50,"column":46}},"callee":{"type":"MemberExpression","start":1175,"end":1207,"loc":{"start":{"line":50,"column":9},"end":{"line":50,"column":41}},"object":{"type":"CallExpression","start":1175,"end":1200,"loc":{"start":{"line":50,"column":9},"end":{"line":50,"column":34}},"callee":{"type":"MemberExpression","start":1175,"end":1192,"loc":{"start":{"line":50,"column":9},"end":{"line":50,"column":26}},"object":{"type":"Identifier","start":1175,"end":1181,"loc":{"start":{"line":50,"column":9},"end":{"line":50,"column":15}},"name":"crypto"},"property":{"type":"Identifier","start":1182,"end":1192,"loc":{"start":{"line":50,"column":16},"end":{"line":50,"column":26}},"name":"createHash"},"computed":false,"optional":false},"arguments":[{"type":"Literal","start":1193,"end":1199,"loc":{"start":{"line":50,"column":27},"end":{"line":50,"column":33}},"value":"sha1","raw":"'sha1'"}],"optional":false},"property":{"type":"Identifier","start":1201,"end":1207,"loc":{"start":{"line":50,"column":35},"end":{"line":50,"column":41}},"name":"update"},"computed":false,"optional":false},"arguments":[{"type":"Identifier","start":1208,"end":1211,"loc":{"start":{"line":50,"column":42},"end":{"line":50,"column":45}},"name":"str"}],"optional":false},"property":{"type":"Identifier","start":1213,"end":1219,"loc":{"start":{"line":50,"column":47},"end":{"line":50,"column":53}},"name":"digest"},"computed":false,"optional":false},"arguments":[{"type":"Literal","start":1220,"end":1225,"loc":{"start":{"line":50,"column":54},"end":{"line":50,"column":59}},"value":"hex","raw":"'hex'"}],"optional":false}}]}}],"sourceType":"module"}